@tailwind components;

@layer components {
  /*
    Invictus Sidebar Skin
    - Sem bloco de marca
    - Denso/Marcante
    - Ativo: barra dourada + capsule glass + highlight metálico
  */

  /* Container (alvo real é o [data-sidebar="sidebar"] interno)
     Assinatura: vinheta + marca d'água (monograma) + "champagne edge" (sem textura). */
  .invictus-sidebar [data-sidebar="sidebar"] {
    position: relative;
    overflow: visible;
    /* Tuning knobs (light defaults; dark overrides below) */
    --sidebar-marble-opacity: 0.10;
    --sidebar-top-highlight-opacity: 0.70;
    --sidebar-marble-blend: soft-light;
    /* Frame (champagne) */
    --sidebar-frame-opacity: 0.88;
    --sidebar-frame-soft: 0.14;
    --sidebar-frame-hot: 0.52;
    /* Light mode: glass mais sólido */
    background: linear-gradient(
      180deg,
      hsl(var(--background) / 0.85) 0%,
      hsl(var(--background) / 0.78) 100%
    );
    backdrop-filter: blur(20px) saturate(140%);
    box-shadow:
      0 0 0 1px hsl(var(--border) / 0.46) inset,
      0 1px 0 0 hsl(var(--foreground) / 0.05) inset,
      0 24px 80px -60px hsl(var(--foreground) / 0.25);
  }

  /* Dark: vidro translúcido + glass mais intenso */
  .dark .invictus-sidebar [data-sidebar="sidebar"] {
    --sidebar-marble-opacity: 0.26;
    --sidebar-top-highlight-opacity: 0.90;
    --sidebar-frame-opacity: 0.96;
    --sidebar-frame-soft: 0.20;
    --sidebar-frame-hot: 0.70;
    background: linear-gradient(
      180deg,
      hsl(var(--background) / 0.22) 0%,
      hsl(var(--background) / 0.12) 100%
    );
    backdrop-filter: blur(24px) saturate(170%);
    box-shadow:
      0 0 0 1px hsl(var(--border) / 0.46) inset,
      0 1px 0 0 hsl(var(--foreground) / 0.08) inset,
      0 24px 80px -60px hsl(var(--foreground) / 0.55);
  }

  /* Borda real (champagne) — sempre fina, sempre visível, sem engrossar */
  .invictus-sidebar [data-sidebar="sidebar"]::after {
    content: "";
    position: absolute;
    inset: 0;
    pointer-events: none;
    border-radius: inherit;
    padding: 1px;
    background: linear-gradient(
      135deg,
      hsl(var(--gold-soft) / var(--sidebar-frame-soft)),
      hsl(var(--gold-hot) / var(--sidebar-frame-hot)) 35%,
      hsl(var(--gold-soft) / 0.26) 70%,
      hsl(var(--gold-hot) / 0.52)
    );
    -webkit-mask:
      linear-gradient(#000 0 0) content-box,
      linear-gradient(#000 0 0);
    -webkit-mask-composite: xor;
    mask-composite: exclude;
    opacity: var(--sidebar-frame-opacity);
  }

  .invictus-sidebar [data-sidebar="sidebar"]::before {
    content: "";
    position: absolute;
    inset: 0;
    pointer-events: none;
    border-radius: inherit;
    background:
      /* top highlight (luz no vidro) */
      radial-gradient(110% 55% at 50% 0%, hsl(var(--gold-soft) / 0.16), transparent 60%),
      /* champagne edge (apenas na borda, quase imperceptível) */
      linear-gradient(135deg, hsl(var(--gold-hot) / 0.08), transparent 60%),
      /* controlled specular */
      linear-gradient(180deg, hsl(var(--foreground) / 0.10), transparent 36%),
      /* "mármore sob o vidro": dourado + grafite, bem sutil */
      radial-gradient(120% 90% at 14% 10%, hsl(var(--gold-hot) / 0.10), transparent 56%),
      radial-gradient(120% 90% at 92% 18%, hsl(var(--gold-soft) / 0.08), transparent 60%),
      /* veios grafite (bem suaves) */
      radial-gradient(130% 110% at 42% 86%, hsl(var(--foreground) / 0.08), transparent 66%),
      radial-gradient(140% 120% at 78% 72%, hsl(var(--foreground) / 0.05), transparent 64%),
      /* direção/fluxo (polido) */
      linear-gradient(135deg, transparent 0%, hsl(var(--gold-hot) / 0.05) 36%, transparent 72%);
    mix-blend-mode: var(--sidebar-marble-blend);
    opacity: var(--sidebar-marble-opacity);
    filter: blur(0.2px);
  }

  /* Seções (como no print) */
  .invictus-sidebar-section {
    padding-top: 0.25rem;
  }

  .invictus-sidebar-section + .invictus-sidebar-section {
    margin-top: 0.75rem;
  }

  .invictus-sidebar-sectionLabel {
    height: auto;
    padding: 0.25rem 0.75rem;
    font-size: 0.9rem;
    font-weight: 650;
    letter-spacing: 0.01em;
    color: hsl(var(--sidebar-foreground) / 0.78);
    opacity: 1 !important;
    margin: 0;
  }

  .invictus-sidebar-menu {
    gap: 0.25rem;
  }

  /* Menu item (aplicado em SidebarMenuButton)
     Motif: "Crest discreto" (placa limpa + friso interno), sem recortes. */
  .invictus-sidebar-item {
    position: relative;
    overflow: hidden;
    isolation: isolate;
    border-radius: 0.9rem;
    background: transparent;
    transition:
      transform 160ms ease,
      box-shadow 180ms ease,
      background-color 180ms ease,
      filter 180ms ease;
  }

  /* Command Deck: sem "placa"/capsule — só friso de precisão */
  .invictus-sidebar-item::before {
    content: "";
    position: absolute;
    inset: 0;
    pointer-events: none;
    background:
      linear-gradient(180deg, hsl(var(--foreground) / 0.10), transparent 46%);
    opacity: 0.10;
    z-index: 0;
    transition: opacity 180ms ease;
  }

  /* Hover discreto (sem lift, sem template) */
  .invictus-sidebar-item:hover {
    transform: none;
    box-shadow: none;
  }

  .invictus-sidebar-item:hover::before {
    opacity: 0.18;
  }

  /* Active: acontece no trilho (notch), não no fundo do item */
  .invictus-sidebar-item[data-active="true"] {
    /* Capsule glass */
    background: linear-gradient(
      180deg,
      hsl(var(--background) / 0.22) 0%,
      hsl(var(--background) / 0.12) 100%
    );
    backdrop-filter: blur(12px) saturate(155%);
    box-shadow: none;
  }

  /* Light mode: capsule mais sólido */
  :root:not(.dark) .invictus-sidebar-item[data-active="true"] {
    background: linear-gradient(
      180deg,
      hsl(var(--background) / 0.65) 0%,
      hsl(var(--background) / 0.55) 100%
    );
  }

  /* Aro fino dourado (capsule) */
  .invictus-sidebar-item[data-active="true"]::after {
    content: "";
    position: absolute;
    inset: 0;
    pointer-events: none;
    border-radius: inherit;
    padding: 1px;
    background: linear-gradient(
      135deg,
      hsl(var(--gold-soft) / 0.12),
      hsl(var(--gold-hot) / 0.62) 35%,
      hsl(var(--gold-soft) / 0.22) 70%,
      hsl(var(--gold-hot) / 0.52)
    );
    -webkit-mask:
      linear-gradient(#000 0 0) content-box,
      linear-gradient(#000 0 0);
    -webkit-mask-composite: xor;
    mask-composite: exclude;
    opacity: 0.9;
    z-index: 0;
  }

  /* Link interno (tipografia/alinhamento) */
  .invictus-sidebar-link {
    position: relative;
    display: flex;
    align-items: center;
    gap: 0.65rem;
    width: 100%;
    border-radius: inherit;
    /* roomy like the reference */
    padding-left: 1.35rem;
    padding-right: 0.85rem;
    padding-block: 0.85rem;
    color: hsl(var(--sidebar-foreground));
    text-decoration: none;
  }

  /* Filete dourado (mais elegante) — fica no link pra não brigar com o aro */
  .invictus-sidebar-item[data-active="true"] .invictus-sidebar-link::before {
    content: "";
    position: absolute;
    left: 0.65rem;
    top: 22%;
    bottom: 22%;
    width: 2px;
    border-radius: 999px;
    background: linear-gradient(
      180deg,
      hsl(var(--gold-soft) / 0.55),
      hsl(var(--gold-hot) / 0.55)
    );
    opacity: 0.65;
  }

  /* Mantém pseudo-elements no fundo e conteúdo acima */
  .invictus-sidebar-item > * {
    position: relative;
    z-index: 1;
  }

  /* Wrapper dedicado para permitir "icon plate" no ativo */
  .invictus-sidebar-iconWrap {
    position: relative;
    display: grid;
    place-items: center;
    width: 2rem;
    height: 2rem;
    flex: 0 0 auto;
    border-radius: 0.85rem;
  }

  .invictus-sidebar-icon {
    width: 1.1rem;
    height: 1.1rem;
    color: hsl(var(--sidebar-foreground) / 0.60);
  }

  .invictus-sidebar-label {
    letter-spacing: 0.015em;
    font-weight: 560;
    color: hsl(var(--sidebar-foreground) / 0.72);
    text-transform: none;
    font-size: 0.95rem;
    line-height: 1.1;
  }

  /* Active text polish */
  .invictus-sidebar-item[data-active="true"] .invictus-sidebar-label {
    color: hsl(var(--sidebar-foreground) / 0.92);
    text-shadow: none;
  }

  /* Icon plate metálico (SÓ no ativo) */
  /* (Crest discreto) sem medalhão: ícone só ganha contraste no ativo */
  .invictus-sidebar-item[data-active="true"] .invictus-sidebar-icon {
    position: relative;
    z-index: 1;
    color: hsl(var(--sidebar-foreground) / 0.86);
    filter: none;
  }

  /* Hover/Focus: comportamento "deck" (contraste, não efeito) */
  .invictus-sidebar-item:hover .invictus-sidebar-label {
    color: hsl(var(--sidebar-foreground) / 0.88);
  }

  .invictus-sidebar-item:hover .invictus-sidebar-icon {
    color: hsl(var(--sidebar-foreground) / 0.78);
  }

  /* Tooltip com skin (para estado colapsado ficar "Invictus") */
  .invictus-tooltip {
    border-radius: 0.85rem;
    background:
      linear-gradient(180deg, hsl(var(--background) / 0.26), hsl(var(--background) / 0.14));
    backdrop-filter: blur(18px);
    color: hsl(var(--foreground));
    border: 1px solid hsl(var(--gold-hot) / 0.32);
    box-shadow:
      0 1px 0 0 hsl(var(--foreground) / 0.10) inset,
      0 18px 70px -44px hsl(var(--foreground) / 0.55);
  }

  /* Light mode: tooltip mais sólido */
  :root:not(.dark) .invictus-tooltip {
    background:
      linear-gradient(180deg, hsl(var(--background) / 0.92), hsl(var(--background) / 0.88));
    box-shadow:
      0 1px 0 0 hsl(var(--foreground) / 0.06) inset,
      0 18px 70px -44px hsl(var(--foreground) / 0.25);
  }

  /* Mini (collapsed): manter mesma assinatura sem "sumir" */
  .group[data-collapsible="icon"] .invictus-sidebar-item {
    border-radius: 0.9rem;
  }
}
