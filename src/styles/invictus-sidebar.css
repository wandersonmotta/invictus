@tailwind components;

@layer components {
  /*
    Invictus Sidebar Skin
    - Sem bloco de marca
    - Denso/Marcante
    - Ativo: barra dourada + capsule glass + highlight metálico
  */

  /* Container (alvo real é o [data-sidebar="sidebar"] interno)
     Assinatura: vinheta + microtextura (sem glow) + “champagne edge”. */
  .invictus-sidebar [data-sidebar="sidebar"] {
    position: relative;
    background:
      radial-gradient(120% 80% at 18% 0%, hsl(var(--gold-soft) / 0.08), transparent 58%),
      radial-gradient(110% 80% at 110% 14%, hsl(var(--gold-hot) / 0.05), transparent 62%),
      linear-gradient(180deg, hsl(var(--card) / var(--glass)) 0%, hsl(var(--card) / 0.18) 100%);
    backdrop-filter: blur(18px);
    box-shadow:
      0 0 0 1px hsl(var(--border) / 0.60) inset,
      0 0 0 1px hsl(var(--gold-hot) / 0.08) inset,
      0 24px 80px -60px hsl(var(--foreground) / 0.55);
  }

  .invictus-sidebar [data-sidebar="sidebar"]::before {
    content: "";
    position: absolute;
    inset: 0;
    pointer-events: none;
    border-radius: inherit;
    background:
      /* champagne edge */
      linear-gradient(
        135deg,
        hsl(var(--gold-soft) / 0.06),
        hsl(var(--gold-hot) / 0.12) 40%,
        transparent 70%
      ),
      /* controlled specular */
      linear-gradient(180deg, hsl(var(--foreground) / 0.10), transparent 34%);
    opacity: 0.95;
  }

  .invictus-sidebar [data-sidebar="sidebar"]::after {
    content: "";
    position: absolute;
    inset: 0;
    pointer-events: none;
    border-radius: inherit;
    /* microtexture: diagonal + faint grid (static, very low opacity) */
    background:
      repeating-linear-gradient(
        135deg,
        hsl(var(--foreground) / 0.04) 0px,
        hsl(var(--foreground) / 0.04) 1px,
        transparent 1px,
        transparent 10px
      ),
      repeating-linear-gradient(
        90deg,
        hsl(var(--foreground) / 0.03) 0px,
        hsl(var(--foreground) / 0.03) 1px,
        transparent 1px,
        transparent 14px
      );
    opacity: 0.22;
    mix-blend-mode: overlay;
  }

  /* Menu item (aplicado em SidebarMenuButton)
     Motif: “Invictus Cut Plate” (cantos chanfrados + friso interno). */
  .invictus-sidebar-item {
    --inv-cut: 10px;
    position: relative;
    overflow: hidden;
    isolation: isolate;
    border-radius: 0.95rem; /* fallback */
    background: transparent;
    transition:
      transform 160ms ease,
      box-shadow 180ms ease,
      background-color 180ms ease,
      filter 180ms ease;
  }

  @supports (clip-path: polygon(0 0)) {
    .invictus-sidebar-item {
      clip-path: polygon(
        var(--inv-cut) 0%,
        calc(100% - var(--inv-cut)) 0%,
        100% var(--inv-cut),
        100% calc(100% - var(--inv-cut)),
        calc(100% - var(--inv-cut)) 100%,
        var(--inv-cut) 100%,
        0% calc(100% - var(--inv-cut)),
        0% var(--inv-cut)
      );
    }
  }

  /* Friso interno (quase invisível, mas “caro”) */
  .invictus-sidebar-item::before {
    content: "";
    position: absolute;
    inset: 0;
    pointer-events: none;
    background:
      linear-gradient(180deg, hsl(var(--foreground) / 0.10), transparent 44%),
      radial-gradient(120% 80% at 12% 0%, hsl(var(--foreground) / 0.10), transparent 60%);
    opacity: 0.18;
    z-index: 0;
    transition: opacity 180ms ease;
  }

  /* Hover discreto: micro lift + friso aparece */
  .invictus-sidebar-item:hover {
    transform: translateY(-0.5px);
    box-shadow: 0 14px 46px -38px hsl(var(--foreground) / 0.55);
  }

  .invictus-sidebar-item:hover::before {
    opacity: 0.30;
  }

  /* Active: placa forte + trilho embutido (hardware), sem glow exagerado */
  .invictus-sidebar-item[data-active="true"] {
    background:
      linear-gradient(180deg, hsl(var(--background) / 0.26), hsl(var(--background) / 0.14)),
      radial-gradient(120% 90% at 18% 0%, hsl(var(--gold-soft) / 0.07), transparent 64%);
    box-shadow:
      /* champagne ring */
      0 0 0 1px hsl(var(--gold-hot) / 0.70) inset,
      0 0 0 1px hsl(var(--border) / 0.55) inset,
      /* specular */
      0 1px 0 0 hsl(var(--foreground) / 0.12) inset,
      /* depth */
      0 18px 60px -44px hsl(var(--foreground) / 0.62);
  }

  .invictus-sidebar-item[data-active="true"]::before {
    opacity: 0.55;
    background:
      linear-gradient(180deg, hsl(var(--foreground) / 0.14), transparent 44%),
      linear-gradient(135deg, hsl(var(--gold-soft) / 0.08), transparent 44%);
  }

  /* Trilho dourado embutido */
  .invictus-sidebar-item[data-active="true"]::after {
    content: "";
    position: absolute;
    left: 8px;
    top: 14%;
    bottom: 14%;
    width: 6px;
    border-radius: 999px;
    background:
      linear-gradient(180deg, hsl(var(--gold-soft) / 0.85), hsl(var(--gold-hot) / 0.95));
    box-shadow:
      inset 0 0 0 1px hsl(var(--gold-hot) / 0.34),
      0 10px 24px -22px hsl(var(--gold-hot) / 0.70);
    opacity: 0.95;
    z-index: 0;
  }

  /* Link interno (tipografia/alinhamento) */
  .invictus-sidebar-link {
    display: flex;
    align-items: center;
    gap: 0.6rem;
    width: 100%;
    border-radius: inherit;
    padding-inline: 0.6rem;
    padding-block: 0.6rem;
    color: hsl(var(--sidebar-foreground));
    text-decoration: none;
  }

  /* Mantém pseudo-elements no fundo e conteúdo acima */
  .invictus-sidebar-item > * {
    position: relative;
    z-index: 1;
  }

  /* Wrapper dedicado para permitir “icon plate” no ativo */
  .invictus-sidebar-iconWrap {
    position: relative;
    display: grid;
    place-items: center;
    width: 2.05rem;
    height: 2.05rem;
    flex: 0 0 auto;
    border-radius: 0.85rem;
  }

  .invictus-sidebar-icon {
    width: 1.1rem;
    height: 1.1rem;
    color: hsl(var(--sidebar-foreground) / 0.82);
  }

  .invictus-sidebar-label {
    letter-spacing: 0.015em;
    font-weight: 620;
    color: hsl(var(--sidebar-foreground) / 0.92);
    text-transform: none;
    font-size: 0.9rem;
    line-height: 1.05;
  }

  /* Active text polish */
  .invictus-sidebar-item[data-active="true"] .invictus-sidebar-label {
    color: hsl(var(--gold-soft) / 0.92);
    text-shadow: 0 0 14px hsl(var(--gold-hot) / 0.14);
  }

  /* Icon plate metálico (SÓ no ativo) */
  .invictus-sidebar-item[data-active="true"] .invictus-sidebar-iconWrap::after {
    content: "";
    position: absolute;
    inset: 0;
    border-radius: inherit;
    background:
      linear-gradient(180deg, hsl(var(--background) / 0.30), hsl(var(--background) / 0.18)),
      radial-gradient(120% 80% at 25% 10%, hsl(var(--foreground) / 0.18), transparent 60%);
    box-shadow:
      0 1px 0 0 hsl(var(--foreground) / 0.12) inset,
      0 0 0 1px hsl(var(--gold-hot) / 0.32) inset;
    opacity: 0.98;
  }

  .invictus-sidebar-item[data-active="true"] .invictus-sidebar-iconWrap::before {
    content: "";
    position: absolute;
    inset: 0;
    border-radius: inherit;
    padding: 1px;
    background: linear-gradient(
      135deg,
      hsl(var(--gold-soft) / 0.18),
      hsl(var(--gold-hot) / 0.75) 35%,
      hsl(var(--gold-soft) / 0.20) 70%,
      hsl(var(--gold-hot) / 0.55)
    );
    -webkit-mask:
      linear-gradient(#000 0 0) content-box,
      linear-gradient(#000 0 0);
    -webkit-mask-composite: xor;
    mask-composite: exclude;
    opacity: 0.95;
  }

  .invictus-sidebar-item[data-active="true"] .invictus-sidebar-icon {
    position: relative;
    z-index: 1;
    color: hsl(var(--gold-soft) / 0.94);
    filter:
      drop-shadow(0 0 10px hsl(var(--gold-hot) / 0.18))
      drop-shadow(0 10px 22px hsl(var(--foreground) / 0.18));
  }

  /* Tooltip com skin (para estado colapsado ficar “Invictus”) */
  .invictus-tooltip {
    border-radius: 0.85rem;
    background:
      linear-gradient(180deg, hsl(var(--background) / 0.26), hsl(var(--background) / 0.14));
    backdrop-filter: blur(18px);
    color: hsl(var(--foreground));
    border: 1px solid hsl(var(--gold-hot) / 0.32);
    box-shadow:
      0 1px 0 0 hsl(var(--foreground) / 0.10) inset,
      0 18px 70px -44px hsl(var(--foreground) / 0.55);
  }

  /* Mini (collapsed): manter mesma assinatura sem “sumir” */
  .group[data-collapsible="icon"] .invictus-sidebar-item {
    border-radius: 0.9rem;
  }
}
