/* ============ Invictus Map (Leaflet) ============ */
.invictus-map {
  /* Establish the base dark void */
  background: hsl(var(--background));
  position: relative;
  overflow: hidden;
  /* Hardware acceleration for the container */
  transform: translate3d(0, 0, 0);
}

/* 
   CINEMATIC FILTER STACK 
   This transforms standard light OSM tiles into a deep, "Command Center" dark mode.
*/
.invictus-map .leaflet-tile-pane {
  filter: 
    /* 1. Invert to make it dark */
    invert(100%) 
    /* 2. Rotate hue to align with gold/blue spectrum */
    hue-rotate(180deg) 
    /* 3. Reduce brightness to background levels */
    brightness(0.6) 
    /* 4. Boost contrast for sharpness */
    contrast(1.2) 
    /* 5. Sepia for the "Gold" tint */
    sepia(0.2) 
    /* 6. Saturate slightly to bring out the gold */
    saturate(1.1);
  opacity: 0.8 !important; /* Allow the dark background to bleed through */
  transition: filter 0.5s ease;
}

/* 
   THE GRID 
   A tactical overlay pattern
*/
.invictus-map-overlay::after {
  content: "";
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 400; /* Above tiles, below markers */
  background-image: 
    linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),
    linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);
  background-size: 40px 40px;
  mask-image: radial-gradient(circle at center, black 40%, transparent 90%);
}

/* 
   THE VIGNETTE 
   Focus the user's attention on the center
*/
.invictus-map-overlay::before {
  content: "";
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 401;
  background: radial-gradient(
    circle at center,
    transparent 0%,
    hsl(var(--background) / 0.4) 70%,
    hsl(var(--background)) 100%
  );
  mix-blend-mode: multiply;
}

/* ========= Tooltip (Cinematic Glass) ========= */
.invictus-map .leaflet-tooltip.invictus-map-tooltip {
  background: hsl(var(--card) / 0.85);
  color: hsl(var(--foreground));
  border: 1px solid hsl(var(--gold-hot) / 0.3);
  border-radius: 4px;
  box-shadow: 
    0 4px 20px -5px hsl(0 0% 0% / 0.5),
    0 0 10px -2px hsl(var(--gold-hot) / 0.2);
  padding: 6px 12px;
  backdrop-filter: blur(8px);
  font-family: 'Outfit', sans-serif;
  font-weight: 500;
  font-size: 0.8rem;
  letter-spacing: 0.02em;
  text-transform: uppercase;
}
.invictus-map .leaflet-tooltip.invictus-map-tooltip::before {
  border-top-color: hsl(var(--gold-hot) / 0.3);
}

/* Remove default Leaflet attributions styling to make it minimal */
.invictus-map .leaflet-control-attribution {
  background: transparent;
  color: hsl(var(--muted-foreground));
  font-size: 9px;
  font-family: monospace;
  opacity: 0.4;
  margin-right: 10px;
}
.invictus-map .leaflet-control-attribution a {
  color: hsl(var(--muted-foreground));
  text-decoration: none;
}

/* 
   PINS 
   Keep them standard but enforce hardware acceleration
*/
.invictus-map-pin-wrap {
  background: transparent;
  border: 0;
  will-change: transform;
}